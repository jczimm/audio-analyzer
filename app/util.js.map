{"version":3,"sources":["util.js"],"names":[],"mappings":"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","file":"util.js","sourcesContent":["/* jshint esnext: true */\r\n\r\nimport path from 'path';\r\nimport fs from 'fs-extra';\r\n\r\nimport notifications from './notifications';\r\n\r\n\r\n// GENERAL UTILITIES\r\n\r\nvar util = {};\r\n\r\nutil.normalize = function normalize(arr, factor) {\r\n    var min = Math.min.apply(Math, arr),\r\n        max = Math.max.apply(Math, arr);\r\n\r\n    return [].slice.call(arr).map(function(val) {\r\n            return (val - min) / (max - min) * (factor || 100);\r\n        });\r\n};\r\n\r\nutil.copyFile = function copyFile(sourcePath, destDir) {\r\n    return new Promise(function(resolve, reject) {\r\n\r\n        var destPath = path.resolve(destDir, path.basename(sourcePath));\r\n\r\n        var readStream = fs.createReadStream(sourcePath),\r\n            writeStream = fs.createWriteStream(destPath);\r\n\r\n        writeStream.on('finish', function() {\r\n            resolve(path.relative(__dirname, destPath));\r\n        });\r\n\r\n        writeStream.on('error', function(err) {\r\n            reject({\r\n                err: err,\r\n                msg: `Error copying ${sourcePath} to ${destPath}`,\r\n                loc: \"util.copyFile\",\r\n                notify: false\r\n            });\r\n        });\r\n\r\n        readStream.pipe(writeStream);\r\n    });\r\n};\r\n\r\n// util.cloneFunc = function(func) {\r\n//     var temp = function temporary() { return func.apply(this, arguments); };\r\n//     for(var key in func) {\r\n//         if (func.hasOwnProperty(key)) {\r\n//             temp[key] = func[key];\r\n//         }\r\n//     }\r\n//     return temp;\r\n// };\r\n\r\n// OOP-RELATED\r\n\r\n// NOTE: util.construct and util.namedFunction need testing\r\n\r\nutil.sliceObj = function sliceObj(obj, start, end) {\r\n    var sliced = {};\r\n    var i = 0;\r\n    for (var k in obj) {\r\n        if (i >= start && i < end)\r\n            sliced[k] = obj[k];\r\n\r\n        i++;\r\n    }\r\n\r\n    return sliced;\r\n};\r\n\r\n// util.construct = function(f, args) {\r\n//     var className = f.constructor.toString().match(/^function (.+)\\(\\)/)[1];\r\n    \r\n//     var namedFunc = util.namedFunction(className, [\"f\", \"args\"], \"f.apply(this, args);\", {f: f, args: args});\r\n\r\n//     return new namedFunc(f, args);\r\n// };\r\n\r\n// util.namedFunction = function(name, args, body, scope, values) {\r\n//     if (typeof args == \"string\")\r\n//         values = scope, scope = body, body = args, args = [];\r\n//     if (!Array.isArray(scope) || !Array.isArray(values)) {\r\n//         if (typeof scope == \"object\") {\r\n//             var keys = Object.keys(scope);\r\n//             values = keys.map(function(p) { return scope[p]; });\r\n//             scope = keys;\r\n//         } else {\r\n//             values = [];\r\n//             scope = [];\r\n//         }\r\n//     }\r\n//     return Function(scope, \"function \"+name+\"(\"+args.join(\", \")+\") {\\n\"+body+\"\\n}\\nreturn \"+name+\";\").apply(null, values);\r\n// };\r\n\r\n// DOM\r\n\r\nutil.resetInput = function resetInput($el) {\r\n    $el.wrap('<form>').closest('form').get(0).reset();\r\n    $el.unwrap();\r\n};\r\n\r\nutil.stopPropagation = function stopPropagation(e) {\r\n    e.stopPropagation();\r\n};\r\n\r\nutil.withRefs = function withRefs($el) {\r\n    return $el.parent().find($el);\r\n};\r\n\r\n// TEMPORARY FILES DIRECTORY\r\n\r\nutil.tmp = {};\r\n\r\nutil.tmp.path = path.resolve(__dirname, \"./tmp\");\r\n\r\nutil.tmp.createDir = function createDir() {\r\n    if (!fs.existsSync(util.tmp.path)) {\r\n        fs.mkdirSync(util.tmp.path);\r\n    }\r\n};\r\n\r\nutil.tmp.copyFileToTmp = function copyFileToTmp(filePath) {\r\n    return util.copyFile(filePath, util.tmp.path);\r\n};\r\n\r\nutil.tmp.copyFilesToTmp = function copyFilesToTmp(filePaths) {\r\n    return Promise.all(filePaths.map(util.tmp.copyFileToTmp));\r\n};\r\n\r\nutil.tmp.cleanUp = function cleanUp() {\r\n    fs.removeSync(util.tmp.path);\r\n};\r\n\r\n// AUDIO UTILIES\r\n\r\nutil.getLengthOfAudioFile = function getLengthOfAudioFile(path) {\r\n    return new Promise(function(resolve, reject) {\r\n        var audio = new Audio();\r\n        audio.src = path;\r\n\r\n        audio.addEventListener(\"canplaythrough\", function(e) {\r\n            resolve(e.currentTarget.duration);\r\n        });\r\n\r\n        audio.addEventListener(\"error\", function(e) {\r\n            var errorInfo = util.handleAudioLoadError(e);\r\n            errorInfo.loc = \"util.getLengthOfAudioFile\";\r\n            reject(errorInfo);\r\n        });\r\n    });\r\n};\r\n\r\nutil.convertSecondsToHHMMSS = function convertSecondsToHHMMSS(seconds) {\r\n    var date = new Date(1970,0,1);\r\n    date.setSeconds(seconds);\r\n    return date.toTimeString().replace(/.*(\\d{2}:\\d{2}:\\d{2}).*/, \"$1\");\r\n\r\n    return date;\r\n};\r\n\r\nutil.handleAudioLoadError = function handleAudioLoadError(e, reject) {\r\n    var err = e.currentTarget.error,\r\n        errMsg;\r\n\r\n    switch (err.code) {\r\n        case err.MEDIA_ERR_ABORTED:\r\n            errMsg = \"Unknown error\";\r\n            break;\r\n\r\n        case err.MEDIA_ERR_NETWORK:\r\n            errMsg = \"Network Error\";\r\n            break;\r\n\r\n        case err.MEDIA_ERR_DECODE:\r\n            errMsg = \"ERR decoding file as an audio file\";\r\n            break;\r\n\r\n        case err.MEDIA_ERR_SRC_NOT_SUPPORTED:\r\n            errMsg = \"Invalid source location\";\r\n            break;\r\n    }\r\n\r\n    var errorInfo = {\r\n        err: err,\r\n        msg: errMsg,\r\n        loc: \"util.handleAudioLoadError\",\r\n        notify: undefined\r\n    };\r\n\r\n    if (typeof reject === \"function\") {\r\n        reject(errorInfo);\r\n    } else return errorInfo;\r\n};\r\n\r\n//\r\n\r\nutil.handleError = function handleError(err) {\r\n    // err :\r\n    // {\r\n    //      err: new Error(),\r\n    //      msg: \"Error Message, displayed in notification if `notify: true`\",\r\n    //      loc: \"erreeFunction\",\r\n    //      args: [argsPassedToErreeFunction], (optional)\r\n    //      notify: false\r\n    // }\r\n\r\n    console.error((`ERR @ ${err.loc}` + (typeof err.args === \"object\" ? `(${err.args.join(\", \")})` : \"\") + \":\"), err.err);\r\n    if (err.notify === true) {\r\n        notifications.err(err.msg);\r\n    }\r\n};\r\n\r\n//\r\n\r\nutil.analyzerOptions = {\r\n    stereo: false,\r\n    audible: false\r\n};\r\n\r\nexport default util;\r\n"],"sourceRoot":"/source/"}